"use strict";function addEvent(){var n=document.querySelector(".disc-container audio");$(".icon-pause").on("click",function(){n.pause(),$(".disc-container").removeClass("playing")}),$(".icon-play").on("click",function(){n.play(),$(".disc-container").addClass("playing")})}function getSongId(){return parseInt(location.href.match(/id=([^&])*/)[1])}function getLyric(n){if(n.hasOwnProperty("lrc")&&n.lrc.hasOwnProperty("lyric")){var t=n.lrc.lyric.split("\n"),e=/^\[(.+)\](.+)/;return t=t.map(function(n,t){var i=n.match(e);if(i)return{time:i[1],words:i[2]}})}return"获取歌词失败"}function dispSongName(n){"string"==typeof n.name&&$(".song-description>h1").text(n.name)}function dispLyric(n){var t=$(".lines");if("string"==typeof n){var e=$("<p/>");return e.text(n),void t.append(e)}n.map(function(n){if(n){var e=$("<p/>");e.attr("data-time",n.time).text(n.words),t.append(e)}})}function playSong(n){var t=document.querySelector(".disc-container audio");t.src=n.url,t.oncanplay=function(){t.play(),$(".disc-container").addClass("playing"),dispSongName(n),dispLyric(getLyric(n)),setInterval(function(){for(var n=t.currentTime,e=~~(n/60),i=n-60*e,a=pad(e)+":"+pad(i),r=$(".lines > p"),o=void 0,c=0;c<r.length;c++)void 0!==r[c+1]&&r.eq(c).attr("data-time")<a&&r.eq(c+1).attr("data-time")>a&&(o=r.eq(c));if(o){o.addClass("active").prev().removeClass("active");var s=o.offset().top-$(".lines").offset().top-$(".lyric").height()/3;$(".lines").css("transform","translateY(-"+s+"px)")}},300)}}function pad(n){return n>=10?n+"":"0"+n}function songDeal(n,t,e){$.get("./../songs.json").then(function(e){var i=e.filter(function(t){return parseInt(t.id)===n});t&&t.apply(null,i),addEvent()})}$(function(){songDeal(getSongId(),playSong)});